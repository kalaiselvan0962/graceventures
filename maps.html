<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>School Expo ‚Ä¢ iOS Navigation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
         :root {
            --ios-bg: #F2F2F7;
            --ios-card: #FFFFFF;
            --ios-card-dark: #1C1C1E;
            --ios-blue: #007AFF;
            --ios-green: #34C759;
            --ios-indigo: #5856D6;
            --ios-orange: #FF9500;
            --ios-red: #FF3B30;
            --ios-purple: #AF52DE;
            --ios-gray1: #8E8E93;
            --ios-gray2: #AEAEB2;
            --ios-gray3: #C7C7CC;
            --ios-gray4: #D1D1D6;
            --ios-gray5: #E5E5EA;
            --ios-gray6: #F2F2F7;
            --ios-text: #000000;
            --ios-text-secondary: #3C3C43;
            --ios-text-tertiary: #8E8E93;
            --ios-shadow: 0px 0px 20px rgba(0, 0, 0, 0.08);
            --ios-shadow-large: 0px 10px 30px rgba(0, 0, 0, 0.12);
            --safe-area-inset-top: env(safe-area-inset-top, 0px);
            --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
            --safe-area-inset-left: env(safe-area-inset-left, 0px);
            --safe-area-inset-right: env(safe-area-inset-right, 0px);
            --sidebar-width: 360px;
        }
        
        @media (prefers-color-scheme: dark) {
             :root {
                --ios-bg: #000000;
                --ios-card: #1C1C1E;
                --ios-card-dark: #2C2C2E;
                --ios-blue: #0A84FF;
                --ios-green: #30D158;
                --ios-indigo: #5E5CE6;
                --ios-orange: #FF9F0A;
                --ios-red: #FF453A;
                --ios-purple: #BF5AF2;
                --ios-gray1: #8E8E93;
                --ios-gray2: #636366;
                --ios-gray3: #48484A;
                --ios-gray4: #3A3A3C;
                --ios-gray5: #2C2C2E;
                --ios-gray6: #1C1C1E;
                --ios-text: #FFFFFF;
                --ios-text-secondary: #EBEBF5;
                --ios-text-tertiary: #8E8E93;
                --ios-shadow: 0px 0px 20px rgba(0, 0, 0, 0.4);
                --ios-shadow-large: 0px 10px 30px rgba(0, 0, 0, 0.5);
            }
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display', 'Helvetica Neue', sans-serif;
            background: var(--ios-bg);
            color: var(--ios-text);
            overflow: hidden;
            height: 100vh;
            -webkit-tap-highlight-color: transparent;
            padding-top: var(--safe-area-inset-top);
            padding-bottom: var(--safe-area-inset-bottom);
        }
        /* iOS Status Bar */
        
        .status-bar {
            height: clamp(44px, 10vh, 60px);
            min-height: 44px;
            background: var(--ios-card);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 max(16px, var(--safe-area-inset-left));
            border-bottom: 0.5px solid var(--ios-gray5);
            position: relative;
            z-index: 1000;
        }
        
        .status-time {
            font-size: clamp(14px, 3vw, 16px);
            font-weight: 600;
        }
        
        .status-icons {
            display: flex;
            gap: clamp(3px, 1vw, 5px);
            align-items: center;
        }
        
        .status-icon {
            font-size: clamp(12px, 2.5vw, 14px);
        }
        /* Header */
        
        .header {
            background: var(--ios-card);
            padding: clamp(8px, 2vh, 12px) clamp(16px, 4vw, 20px);
            border-bottom: 0.5px solid var(--ios-gray5);
            position: relative;
            z-index: 999;
        }
        
        .header-content {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }
        
        .header-title {
            font-size: clamp(22px, 5vw, 28px);
            font-weight: 700;
            letter-spacing: -0.5px;
            background: linear-gradient(90deg, var(--ios-blue), var(--ios-purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .header-subtitle {
            font-size: clamp(13px, 3vw, 15px);
            color: var(--ios-text-tertiary);
            font-weight: 400;
            margin-top: 2px;
        }
        
        .header-actions {
            display: flex;
            gap: clamp(8px, 2vw, 15px);
            align-items: center;
        }
        
        .header-btn {
            width: clamp(32px, 8vw, 36px);
            height: clamp(32px, 8vw, 36px);
            background: var(--ios-gray6);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(16px, 4vw, 18px);
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            color: var(--ios-text);
            flex-shrink: 0;
        }
        
        .header-btn:hover {
            background: var(--ios-gray5);
            transform: scale(1.05);
        }
        
        /* Redirect Button Styles */
        /* Redirect Button Styles */
.redirect-button-container {
    text-align: center;
    padding: 16px 20px;
    background: var(--ios-card);
    border-bottom: 0.5px solid var(--ios-gray5);
}

.redirect-btn {
    background: linear-gradient(135deg, #8A2BE2, #9400D3);
    color: white;
    border: none;
    border-radius: 14px;
    padding: 14px 28px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    width: 100%;
    max-width: 300px;
}

.redirect-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(138, 43, 226, 0.4);
    background: linear-gradient(135deg, #9400D3, #8A2BE2);
}

.redirect-btn:active {
    transform: translateY(0);
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
    .redirect-btn {
        background: linear-gradient(135deg, #9B30FF, #8A2BE2);
        box-shadow: 0 4px 15px rgba(155, 48, 255, 0.4);
    }
    
    .redirect-btn:hover {
        background: linear-gradient(135deg, #8A2BE2, #9B30FF);
        box-shadow: 0 8px 20px rgba(155, 48, 255, 0.5);
    }
}

/* Responsive styles for redirect button */
@media (max-width: 767px) {
    .redirect-button-container {
        padding: 12px 16px;
    }
    
    .redirect-btn {
        padding: 12px 20px;
        font-size: 15px;
        max-width: 280px;
    }
}

@media (max-width: 480px) {
    .redirect-btn {
        padding: 11px 18px;
        font-size: 14px;
        max-width: 260px;
    }
    
    .redirect-btn span {
        font-size: 14px;
    }
}
        /* Main Container */
        
        .main-container {
            display: flex;
            height: calc(100vh - clamp(120px, 22vh, 140px));
            position: relative;
            width: 100%;
        }
        /* Sidebar Toggle Button */
        
        .sidebar-toggle {
            position: fixed;
            top: 120px;
            left: 20px;
            width: 44px;
            height: 44px;
            background: var(--ios-card);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: var(--ios-shadow);
            border: 1px solid var(--ios-gray5);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        .sidebar-toggle:hover {
            background: var(--ios-gray6);
            transform: scale(1.1);
        }
        
        .sidebar-toggle.hidden {
            left: 380px;
        }
        /* Sidebar - iOS Style */
        
        .sidebar {
            width: var(--sidebar-width);
            background: var(--ios-card);
            border-right: 0.5px solid var(--ios-gray5);
            padding: clamp(16px, 3vw, 20px);
            overflow-y: auto;
            position: relative;
            z-index: 100;
            flex-shrink: 0;
            transform: translateX(0);
            transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            height: 100%;
        }
        
        .sidebar.hidden {
            transform: translateX(-100%);
            display: none;
        }
        
        .sidebar-visible {
            transform: translateX(0) !important;
            display: block !important;
        }
        
        .sidebar-section {
            margin-bottom: clamp(20px, 4vh, 30px);
        }
        
        .section-title {
            font-size: clamp(11px, 2vw, 13px);
            font-weight: 600;
            color: var(--ios-text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: clamp(12px, 3vh, 15px);
            padding-left: 10px;
        }
        /* Subject Cards - iOS Style */
        
        .subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: clamp(10px, 2vw, 15px);
        }
        
        .subject-card {
            background: var(--ios-gray6);
            border-radius: clamp(12px, 3vw, 16px);
            padding: clamp(15px, 3vw, 20px);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .subject-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--ios-shadow);
            border-color: var(--ios-gray4);
        }
        
        .subject-card.active {
            background: rgba(10, 132, 255, 0.1);
            border-color: var(--ios-blue);
            box-shadow: 0 0 0 3px rgba(10, 132, 255, 0.15);
        }
        
        .subject-icon {
            width: clamp(40px, 10vw, 48px);
            height: clamp(40px, 10vw, 48px);
            background: linear-gradient(135deg, var(--ios-blue), var(--ios-indigo));
            border-radius: clamp(10px, 2vw, 12px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(20px, 5vw, 24px);
            margin-bottom: clamp(12px, 3vh, 15px);
            color: white;
        }
        
        .subject-card.english .subject-icon {
            background: linear-gradient(135deg, #007AFF, #5856D6);
        }
        
        .subject-card.tamil .subject-icon {
            background: linear-gradient(135deg, #FF3B30, #FF9500);
        }
        
        .subject-card.science .subject-icon {
            background: linear-gradient(135deg, #34C759, #30B0C7);
        }
        
        .subject-card.social .subject-icon {
            background: linear-gradient(135deg, #FF9500, #FFCC00);
        }
        
        .subject-card.maths .subject-icon {
            background: linear-gradient(135deg, #AF52DE, #FF2D55);
        }
        
        .subject-card.computer .subject-icon {
            background: linear-gradient(135deg, #32D74B, #64D2FF);
        }
        
        .subject-name {
            font-size: clamp(15px, 3vw, 17px);
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--ios-text);
            word-break: break-word;
        }
        
        .subject-room {
            font-size: clamp(11px, 2vw, 13px);
            font-weight: 500;
            color: var(--ios-text-tertiary);
        }
        /* Current Location Card */
        
        .current-location-card {
            background: var(--ios-card);
            border-radius: clamp(14px, 3vw, 16px);
            padding: clamp(18px, 4vw, 25px);
            margin-top: clamp(15px, 3vh, 20px);
            border: 1px solid var(--ios-gray5);
            box-shadow: var(--ios-shadow);
        }
        
        .location-header {
            display: flex;
            align-items: center;
            gap: clamp(10px, 3vw, 15px);
            margin-bottom: clamp(15px, 4vh, 20px);
        }
        
        .location-icon {
            width: clamp(44px, 10vw, 52px);
            height: clamp(44px, 10vw, 52px);
            background: linear-gradient(135deg, var(--ios-blue), var(--ios-indigo));
            border-radius: clamp(12px, 3vw, 14px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(22px, 5vw, 26px);
            color: white;
            flex-shrink: 0;
        }
        
        .location-info h3 {
            font-size: clamp(18px, 4vw, 20px);
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .location-info p {
            font-size: clamp(13px, 3vw, 15px);
            color: var(--ios-text-tertiary);
            font-weight: 400;
        }
        /* Stats Grid */
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            gap: clamp(8px, 2vw, 12px);
            margin-top: clamp(15px, 3vh, 20px);
        }
        
        .stat-item {
            text-align: center;
            padding: clamp(12px, 3vw, 15px);
            background: var(--ios-gray6);
            border-radius: clamp(10px, 2vw, 12px);
        }
        
        .stat-value {
            font-size: clamp(18px, 4vw, 22px);
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .stat-value.distance {
            color: var(--ios-green);
        }
        
        .stat-value.floor {
            color: var(--ios-blue);
        }
        
        .stat-value.eta {
            color: var(--ios-orange);
        }
        
        .stat-value.room {
            color: var(--ios-purple);
        }
        
        .stat-label {
            font-size: clamp(10px, 2vw, 12px);
            color: var(--ios-text-tertiary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        /* Navigation Controls */
        
        .nav-controls {
            margin-top: clamp(20px, 4vh, 25px);
        }
        
        .nav-button {
            width: 100%;
            padding: clamp(16px, 4vw, 18px);
            background: var(--ios-blue);
            border: none;
            border-radius: clamp(12px, 3vw, 14px);
            color: white;
            font-size: clamp(15px, 3vw, 17px);
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            margin-bottom: clamp(8px, 2vh, 12px);
            flex-wrap: wrap;
        }
        
        .nav-button span {
            white-space: nowrap;
        }
        
        .nav-button:hover {
            background: var(--ios-blue);
            opacity: 0.9;
            transform: scale(1.02);
        }
        
        .nav-button.secondary {
            background: var(--ios-gray5);
            color: var(--ios-text);
        }
        /* Map Container */
        
        .map-container {
            flex: 1;
            position: relative;
            background: var(--ios-card-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            min-width: 0;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            width: 100%;
            height: 100%;
        }
        /* Map Wrapper - Centered */
        
        .map-wrapper {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: pan-x pan-y;
        }
        /* U-Shaped School Map */
        
        .u-shaped-map {
            position: relative;
            width: min(600px, 90%);
            height: min(400px, 90%);
            display: flex;
            align-items: center;
            justify-content: center;
            transform-origin: center;
            transition: all 0.3s ease;
        }
        /* Building Structure */
        
        .building-outline {
            position: absolute;
            width: 100%;
            height: 100%;
            border: max(2px, 0.5vw) solid var(--ios-gray3);
            border-radius: clamp(20px, 5vw, 30px);
            background: rgba(255, 255, 255, 0.05);
            box-shadow: var(--ios-shadow-large);
        }
        
        .building-u-shape {
            position: absolute;
            width: 80%;
            height: 70%;
            border: max(2px, 0.4vw) solid var(--ios-gray2);
            border-top: none;
            border-radius: 0 0 clamp(20px, 5vw, 30px) clamp(20px, 5vw, 30px);
        }
        /* Rooms - iOS Style */
        
        .room {
            position: absolute;
            background: var(--ios-card);
            border-radius: clamp(12px, 3vw, 14px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: var(--ios-shadow);
            border: max(1px, 0.3vw) solid transparent;
            z-index: 10;
            padding: 5px;
            box-sizing: border-box;
        }
        
        .room:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: var(--ios-shadow-large);
        }
        
        .room.active {
            background: rgba(10, 132, 255, 0.15);
            border-color: var(--ios-blue);
            box-shadow: 0 0 0 4px rgba(10, 132, 255, 0.2), var(--ios-shadow-large);
            animation: iosPulse 2s infinite;
        }
        
        @keyframes iosPulse {
            0%,
            100% {
                box-shadow: 0 0 0 4px rgba(10, 132, 255, 0.2), var(--ios-shadow-large);
            }
            50% {
                box-shadow: 0 0 0 8px rgba(10, 132, 255, 0.1), var(--ios-shadow-large);
            }
        }
        
        .room-icon {
            font-size: clamp(18px, 4vw, 24px);
            margin-bottom: clamp(4px, 1vw, 8px);
        }
        
        .room-name {
            font-size: clamp(12px, 2.5vw, 14px);
            font-weight: 600;
            color: var(--ios-text);
            text-align: center;
            word-break: break-word;
            line-height: 1.2;
        }
        
        .room-number {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--ios-red);
            color: white;
            font-size: clamp(10px, 2vw, 12px);
            font-weight: 700;
            padding: clamp(3px, 1vw, 4px) clamp(6px, 1.5vw, 10px);
            border-radius: 20px;
            border: 2px solid var(--ios-card);
            min-width: 25px;
            text-align: center;
        }
        /* Room Positions */
        
        .room-english {
            top: 10%;
            left: 5%;
            width: clamp(90px, 20vw, 120px);
            height: clamp(70px, 25vh, 100px);
        }
        
        .room-maths {
            top: 10%;
            left: 35%;
            width: clamp(90px, 20vw, 120px);
            height: clamp(70px, 25vh, 100px);
        }
        
        .room-science {
            top: 10%;
            right: 5%;
            width: clamp(90px, 20vw, 120px);
            height: clamp(70px, 25vh, 100px);
        }
        
        .room-computer {
            bottom: 10%;
            right: 5%;
            width: clamp(90px, 20vw, 120px);
            height: clamp(70px, 25vh, 100px);
        }
        
        .room-social {
            bottom: 10%;
            left: 35%;
            width: clamp(90px, 20vw, 120px);
            height: clamp(70px, 25vh, 100px);
        }
        
        .room-tamil {
            bottom: 10%;
            left: 5%;
            width: clamp(90px, 20vw, 120px);
            height: clamp(70px, 25vh, 100px);
        }
        /* Navigation Path */
        
        .nav-path {
            position: absolute;
            height: clamp(4px, 1vw, 6px);
            background: linear-gradient(90deg, transparent 0%, var(--ios-green) 20%, var(--ios-green) 80%, transparent 100%);
            border-radius: 3px;
            transform-origin: left center;
            pointer-events: none;
            z-index: 5;
            opacity: 0;
            filter: drop-shadow(0 0 10px var(--ios-green));
        }
        
        .nav-path.active {
            animation: drawPath 2s ease-in-out forwards;
        }
        
        @keyframes drawPath {
            0% {
                opacity: 0;
                transform: scaleX(0);
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 1;
                transform: scaleX(1);
            }
        }
        /* User Marker */
        
        .user-marker {
            position: absolute;
            width: clamp(30px, 8vw, 40px);
            height: clamp(30px, 8vw, 40px);
            background: var(--ios-blue);
            border-radius: 20px;
            border: max(2px, 0.5vw) solid var(--ios-card);
            box-shadow: var(--ios-shadow-large);
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: clamp(16px, 4vw, 20px);
            transition: all 2s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        .user-marker::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--ios-blue);
            animation: ripple 2s infinite;
            z-index: -1;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        /* Entrance Markers */
        
        .entrance {
            position: absolute;
            width: clamp(40px, 10vw, 50px);
            height: clamp(40px, 10vw, 50px);
            background: var(--ios-orange);
            border-radius: clamp(10px, 2vw, 12px);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: clamp(16px, 4vw, 20px);
            cursor: pointer;
            z-index: 20;
            border: max(2px, 0.5vw) solid var(--ios-card);
            box-shadow: var(--ios-shadow);
            transition: all 0.3s ease;
        }
        
        .entrance:hover {
            transform: scale(1.1);
        }
        
        .entrance-1 {
            top: 50%;
            left: clamp(-20px, -5vw, -25px);
        }
        
        .entrance-2 {
            top: 50%;
            right: clamp(-20px, -5vw, -25px);
        }
        
        .entrance-label {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--ios-card);
            color: var(--ios-text);
            padding: clamp(4px, 1vw, 6px) clamp(8px, 2vw, 12px);
            border-radius: clamp(8px, 2vw, 10px);
            font-size: clamp(10px, 2vw, 12px);
            font-weight: 600;
            white-space: nowrap;
            box-shadow: var(--ios-shadow);
            border: 1px solid var(--ios-gray5);
        }
        /* Map Controls - iOS Style */
        
        .map-controls {
            position: absolute;
            bottom: clamp(15px, 3vh, 30px);
            right: clamp(15px, 3vw, 30px);
            display: flex;
            flex-direction: column;
            gap: clamp(10px, 2vh, 15px);
            z-index: 1000;
        }
        
        .map-control-btn {
            width: clamp(40px, 10vw, 50px);
            height: clamp(40px, 10vw, 50px);
            background: var(--ios-card);
            border-radius: clamp(12px, 3vw, 14px);
            border: 1px solid var(--ios-gray5);
            color: var(--ios-text);
            font-size: clamp(16px, 4vw, 20px);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: var(--ios-shadow);
            backdrop-filter: blur(20px);
        }
        
        .map-control-btn:hover {
            background: var(--ios-gray6);
            transform: scale(1.1);
        }
        /* Quick Access Bar */
        
        .quick-access {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }
        
        .quick-access-btn {
            width: 44px;
            height: 44px;
            background: var(--ios-card);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            box-shadow: var(--ios-shadow);
            border: 1px solid var(--ios-gray5);
            transition: all 0.3s ease;
        }
        
        .quick-access-btn:hover {
            background: var(--ios-gray6);
            transform: scale(1.1);
        }
        /* Loading Screen - iOS Style */
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--ios-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loading-logo {
            width: clamp(60px, 15vw, 80px);
            height: clamp(60px, 15vw, 80px);
            background: linear-gradient(135deg, var(--ios-blue), var(--ios-purple));
            border-radius: clamp(16px, 4vw, 20px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(28px, 7vw, 36px);
            margin-bottom: clamp(20px, 5vh, 30px);
            animation: loadingPulse 1.5s ease-in-out infinite;
        }
        
        @keyframes loadingPulse {
            0%,
            100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }
        
        .loading-text {
            font-size: clamp(15px, 3vw, 17px);
            font-weight: 600;
            color: var(--ios-text);
            margin-bottom: clamp(8px, 2vh, 10px);
        }
        
        .loading-subtext {
            font-size: clamp(13px, 3vw, 15px);
            color: var(--ios-text-tertiary);
            text-align: center;
            max-width: min(300px, 80vw);
            padding: 0 20px;
        }
        /* Modal - iOS Style */
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            padding: var(--safe-area-inset-top) var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left);
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background: var(--ios-card);
            border-radius: clamp(16px, 4vw, 20px);
            width: 90%;
            max-width: min(400px, 95vw);
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--ios-shadow-large);
            transform: translateY(20px);
            transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: clamp(20px, 5vw, 25px);
            border-bottom: 0.5px solid var(--ios-gray5);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-title {
            font-size: clamp(18px, 4vw, 22px);
            font-weight: 700;
        }
        
        .modal-close {
            width: clamp(28px, 7vw, 32px);
            height: clamp(28px, 7vw, 32px);
            background: var(--ios-gray6);
            border-radius: clamp(8px, 2vw, 10px);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: clamp(16px, 4vw, 18px);
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: var(--ios-gray5);
        }
        
        .modal-body {
            padding: clamp(20px, 5vw, 25px);
        }
        
        .modal-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: clamp(10px, 3vw, 15px);
            margin-bottom: clamp(20px, 5vh, 25px);
        }
        
        .modal-info-item {
            background: var(--ios-gray6);
            border-radius: clamp(10px, 2vw, 12px);
            padding: clamp(12px, 3vw, 15px);
        }
        
        .modal-info-label {
            font-size: clamp(11px, 2.5vw, 13px);
            color: var(--ios-text-tertiary);
            margin-bottom: 6px;
            font-weight: 500;
        }
        
        .modal-info-value {
            font-size: clamp(15px, 3vw, 17px);
            font-weight: 600;
            color: var(--ios-text);
        }
        /* Touch-friendly improvements */
        
        @media (hover: none) and (pointer: coarse) {
            .header-btn:hover,
            .subject-card:hover,
            .room:hover,
            .map-control-btn:hover,
            .nav-button:hover,
            .sidebar-toggle:hover,
            .quick-access-btn:hover {
                transform: none;
            }
            .subject-card:active,
            .room:active {
                transform: scale(0.98);
            }
        }
        /* Responsive styles for redirect button */
        @media (max-width: 767px) {
            .redirect-button-container {
                padding: 12px 16px;
            }
            
            .redirect-btn {
                padding: 12px 20px;
                font-size: 15px;
                max-width: 280px;
            }
        }
        
        @media (max-width: 480px) {
            .redirect-btn {
                padding: 11px 18px;
                font-size: 14px;
                max-width: 260px;
            }
            
            .redirect-btn span {
                font-size: 14px;
            }
        }
        /* Orientation-specific adjustments */
        
        @media (orientation: portrait) {
            .main-container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                height: clamp(300px, 40vh, 400px);
                border-right: none;
                border-bottom: 0.5px solid var(--ios-gray5);
            }
            .map-container {
                height: calc(60vh - 100px);
            }
            .u-shaped-map {
                width: 95%;
                height: 95%;
            }
            .sidebar-toggle {
                top: 10px;
                left: 10px;
            }
            .quick-access {
                top: 10px;
                right: 10px;
                flex-direction: row;
            }
        }
        
        @media (orientation: landscape) and (max-height: 600px) {
            .main-container {
                height: calc(100vh - 100px);
            }
            .sidebar {
                width: clamp(250px, 35vw, 320px);
            }
            .subject-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .subject-card {
                padding: 12px;
            }
            .subject-icon {
                width: 36px;
                height: 36px;
                font-size: 20px;
            }
        }
        /* Tablet Optimizations */
        
        @media (min-width: 768px) and (max-width: 1024px) {
            .sidebar {
                width: 320px;
            }
            .subject-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .u-shaped-map {
                width: 500px;
                height: 350px;
            }
        }
        /* Mobile Optimizations */
        
        @media (max-width: 767px) {
            .status-bar {
                padding: 0 12px;
            }
            .header-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            .header-actions {
                align-self: flex-end;
            }
            .sidebar {
                padding: 12px;
                width: 280px;
            }
            .subject-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            .subject-card {
                padding: 12px;
            }
            .subject-icon {
                width: 36px;
                height: 36px;
                font-size: 20px;
                margin-bottom: 10px;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .room {
                width: 80px;
                height: 70px;
            }
            .room-name {
                font-size: 12px;
            }
            .map-controls {
                bottom: 10px;
                right: 10px;
            }
            .map-control-btn {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
            .nav-button {
                padding: 14px;
            }
            .sidebar-toggle {
                width: 36px;
                height: 36px;
                font-size: 18px;
                top: 10px;
                left: 10px;
            }
            .quick-access-btn {
                width: 36px;
                height: 36px;
                font-size: 18px;
            }
        }
        /* Small Mobile Screens */
        
        @media (max-width: 480px) {
            .header-title {
                font-size: 20px;
            }
            .header-subtitle {
                font-size: 12px;
            }
            .header-btn {
                width: 28px;
                height: 28px;
                font-size: 14px;
            }
            .subject-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            .subject-card {
                padding: 10px;
            }
            .subject-name {
                font-size: 14px;
            }
            .subject-room {
                font-size: 11px;
            }
            .location-info h3 {
                font-size: 16px;
            }
            .location-info p {
                font-size: 12px;
            }
            .room {
                width: 70px;
                height: 60px;
            }
            .room-icon {
                font-size: 16px;
                margin-bottom: 4px;
            }
            .room-name {
                font-size: 11px;
            }
            .room-number {
                font-size: 10px;
                padding: 2px 6px;
                top: -8px;
                right: -8px;
            }
            .sidebar-toggle {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
            .quick-access-btn {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
        }
        /* Large Screens */
        
        @media (min-width: 1440px) {
            .sidebar {
                width: 400px;
            }
            .subject-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
            .u-shaped-map {
                width: 700px;
                height: 500px;
            }
            .room {
                width: 140px;
                height: 120px;
            }
        }
        /* For landscape phones */
        
        @media (orientation: landscape) and (max-height: 500px) {
            .sidebar {
                overflow-y: auto;
                height: 100%;
            }
            .subject-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            .current-location-card {
                padding: 15px;
            }
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }
            .stat-item {
                padding: 10px;
            }
            .stat-value {
                font-size: 16px;
            }
        }
        /* Scrollbar Styling */
        
         ::-webkit-scrollbar {
            width: 6px;
        }
        
         ::-webkit-scrollbar-track {
            background: transparent;
        }
        
         ::-webkit-scrollbar-thumb {
            background: var(--ios-gray4);
            border-radius: 3px;
        }
        
         ::-webkit-scrollbar-thumb:hover {
            background: var(--ios-gray3);
        }
    </style>
</head>

<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-logo">üè´</div>
        <div class="loading-text">School Expo Navigation</div>
        <div class="loading-subtext">Loading your campus guide...</div>
    </div>

    <!-- iOS Status Bar -->
    <div class="status-bar">
        <div class="status-time" id="currentTime">9:41</div>
        <div class="status-icons">
            <span class="status-icon">üì∂</span>
            <span class="status-icon">üì°</span>
            <span class="status-icon">üîã</span>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div>
                <div class="header-title">School Expo</div>
                <div class="header-subtitle">Interactive Navigation Guide</div>
            </div>
            <div class="header-actions">
                <button class="header-btn" onclick="toggleTheme()">üåì</button>
                <button class="header-btn" onclick="showHelp()">‚ùì</button>
                <button class="header-btn" onclick="resetNavigation()">üîÑ</button>
            </div>
        </div>
    </div>

    <!-- Redirect Button -->
    <div class="redirect-button-container">
        <button id="redirectButton" class="redirect-btn">
            <i class="fas fa-map-marker-alt"></i>
            <span>Meet the Creators</span>
        </button>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar Toggle Button -->
        <div class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()">üìö</div>

        <!-- Quick Access Bar -->
        <div class="quick-access" id="quickAccess">
            <div class="quick-access-btn" onclick="showQuickSelect()">
                üéØ
            </div>
            <div class="quick-access-btn" onclick="showLocationInfo()">
                ‚ÑπÔ∏è
            </div>
        </div>

        <!-- Sidebar -->
        <div class="sidebar hidden" id="sidebar">
            <div class="sidebar-section">
                <div class="section-title">Subject Exhibits</div>
                <div class="subject-grid" id="subjectGrid"></div>
            </div>

            <div class="current-location-card">
                <div class="location-header">
                    <div class="location-icon" id="currentLocationIcon">üìç</div>
                    <div class="location-info">
                        <h3 id="currentLocation">Select a Room</h3>
                        <p id="locationStatus">Choose an exhibit to begin navigation</p>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value distance" id="statDistance">--</div>
                        <div class="stat-label">Distance</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value floor" id="statFloor">1</div>
                        <div class="stat-label">Floor</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value eta" id="statETA">--</div>
                        <div class="stat-label">ETA</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value room" id="statRoom">--</div>
                        <div class="stat-label">Room No</div>
                    </div>
                </div>

                <div class="nav-controls">
                    <button class="nav-button" onclick="startNavigation()" id="navButton">
                        <span>üìç</span>
                        <span>Start Navigation</span>
                    </button>
                    <button class="nav-button secondary" onclick="findQuickestRoute()">
                        <span>‚ö°</span>
                        <span>Quickest Route</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Map Container -->
        <div class="map-container" id="mapContainer">
            <div class="map-wrapper">
                <!-- U-Shaped School Map -->
                <div class="u-shaped-map" id="uShapedMap">
                    <div class="building-outline"></div>
                    <div class="building-u-shape"></div>

                    <!-- Rooms -->
                    <div class="room room-english" id="roomEnglish" onclick="selectSubject('english')">
                        <div class="room-icon">üìö</div>
                        <div class="room-name">English</div>
                        <div class="room-number">20</div>
                    </div>

                    <div class="room room-maths" id="roomMaths" onclick="selectSubject('maths')">
                        <div class="room-icon">üìê</div>
                        <div class="room-name">Maths</div>
                        <div class="room-number">4</div>
                    </div>

                    <div class="room room-science" id="roomScience" onclick="selectSubject('science')">
                        <div class="room-icon">üî¨</div>
                        <div class="room-name">Science</div>
                        <div class="room-number">5</div>
                    </div>

                    <div class="room room-computer" id="roomComputer" onclick="selectSubject('computer')">
                        <div class="room-icon">üíª</div>
                        <div class="room-name">Computer</div>
                        <div class="room-number">22</div>
                    </div>

                    <div class="room room-social" id="roomSocial" onclick="selectSubject('social')">
                        <div class="room-icon">üåç</div>
                        <div class="room-name">Social</div>
                        <div class="room-number">24</div>
                    </div>

                    <div class="room room-tamil" id="roomTamil" onclick="selectSubject('tamil')">
                        <div class="room-icon">ü™∂</div>
                        <div class="room-name">Tamil</div>
                        <div class="room-number">21</div>
                    </div>

                    <!-- Navigation Path -->
                    <div class="nav-path" id="navPath"></div>

                    <!-- User Marker -->
                    <div class="user-marker" id="userMarker" style="display: none;">
                        üë®‚Äçüë©‚Äçüëß
                    </div>

                    <!-- Entrance Gates -->
                    <div class="entrance entrance-1" onclick="selectEntrance(1)">
                        <div class="entrance-label">Parents Entry</div>
                        üö™
                    </div>

                    <div class="entrance entrance-2" onclick="selectEntrance(2)">
                        <div class="entrance-label">Main Entry</div>
                        üö™
                    </div>
                </div>
            </div>

            <!-- Map Controls -->
            <div class="map-controls">
                <button class="map-control-btn" onclick="zoomIn()">+</button>
                <button class="map-control-btn" onclick="zoomOut()">-</button>
                <button class="map-control-btn" onclick="rotateLeft()">‚Ü∂</button>
                <button class="map-control-btn" onclick="rotateRight()">‚Ü∑</button>
                <button class="map-control-btn" onclick="resetMap()">‚ü≥</button>
            </div>
        </div>
    </div>

    <!-- Room Modal -->
    <div class="modal" id="roomModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Room Details</div>
                <div class="modal-close" onclick="closeModal()">‚úï</div>
            </div>
            <div class="modal-body">
                <div class="modal-info-grid">
                    <div class="modal-info-item">
                        <div class="modal-info-label">Room Number</div>
                        <div class="modal-info-value" id="modalRoomNumber">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label">Subject</div>
                        <div class="modal-info-value" id="modalSubject">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label">Distance</div>
                        <div class="modal-info-value" id="modalDistance">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label">ETA</div>
                        <div class="modal-info-value" id="modalETA">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label">Teacher</div>
                        <div class="modal-info-value" id="modalTeacher">--</div>
                    </div>
                    <div class="modal-info-item">
                        <div class="modal-info-label">Students</div>
                        <div class="modal-info-value" id="modalStudents">--</div>
                    </div>
                </div>
                <button class="nav-button" onclick="navigateToModalRoom()" style="width: 100%;">
                    <span>üìç</span>
                    <span>Navigate to this Room</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Quick Select Modal -->
    <div class="modal" id="quickSelectModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Quick Select</div>
                <div class="modal-close" onclick="closeQuickSelect()">‚úï</div>
            </div>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                    <button class="subject-card" onclick="selectSubjectFromModal('english')" style="padding: 15px;">
                        <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #007AFF, #5856D6); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; margin-bottom: 10px;">üìö</div>
                        <div style="font-weight: 600;">English</div>
                        <div style="font-size: 12px; color: var(--ios-text-tertiary);">Room 20</div>
                    </button>
                    <button class="subject-card" onclick="selectSubjectFromModal('tamil')" style="padding: 15px;">
                        <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #FF3B30, #FF9500); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; margin-bottom: 10px;">ü™∂</div>
                        <div style="font-weight: 600;">Tamil</div>
                        <div style="font-size: 12px; color: var(--ios-text-tertiary);">Room 21</div>
                    </button>
                    <button class="subject-card" onclick="selectSubjectFromModal('science')" style="padding: 15px;">
                        <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #34C759, #30B0C7); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; margin-bottom: 10px;">üî¨</div>
                        <div style="font-weight: 600;">Science</div>
                        <div style="font-size: 12px; color: var(--ios-text-tertiary);">Room 5</div>
                    </button>
                    <button class="subject-card" onclick="selectSubjectFromModal('social')" style="padding: 15px;">
                        <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #FF9500, #FFCC00); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; margin-bottom: 10px;">üåç</div>
                        <div style="font-weight: 600;">Social</div>
                        <div style="font-size: 12px; color: var(--ios-text-tertiary);">Room 24</div>
                    </button>
                    <button class="subject-card" onclick="selectSubjectFromModal('maths')" style="padding: 15px;">
                        <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #AF52DE, #FF2D55); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; margin-bottom: 10px;">üìê</div>
                        <div style="font-weight: 600;">Maths</div>
                        <div style="font-size: 12px; color: var(--ios-text-tertiary);">Room 4</div>
                    </button>
                    <button class="subject-card" onclick="selectSubjectFromModal('computer')" style="padding: 15px;">
                        <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #32D74B, #64D2FF); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white; margin-bottom: 10px;">üíª</div>
                        <div style="font-weight: 600;">Computer</div>
                        <div style="font-size: 12px; color: var(--ios-text-tertiary);">Room 22</div>
                    </button>
                </div>
                <button class="nav-button secondary" onclick="closeQuickSelect()" style="width: 100%; margin-top: 20px;">
                    <span>‚Üê</span>
                    <span>Back</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Subject data
        const subjects = {
            english: {
                name: 'English Expo',
                floor: 1,
                room: '20',
                icon: 'üìö',
                color: '#007AFF',
                distance: 120,
                eta: '2 min',
                students: '25',
                teacher: 'Ms. Smith',
                coordinates: {
                    x: 100,
                    y: 100
                }
            },
            tamil: {
                name: 'Tamil Expo',
                floor: 1,
                room: '21',
                icon: 'ü™∂',
                color: '#FF3B30',
                distance: 350,
                eta: '5 min',
                students: '18',
                teacher: 'Mr. Kumar',
                coordinates: {
                    x: 100,
                    y: 300
                }
            },
            science: {
                name: 'Science Expo',
                floor: 1,
                room: '5',
                icon: 'üî¨',
                color: '#34C759',
                distance: 250,
                eta: '3 min',
                students: '32',
                teacher: 'Dr. Brown',
                coordinates: {
                    x: 400,
                    y: 100
                }
            },
            social: {
                name: 'Social Expo',
                floor: 1,
                room: '24',
                icon: 'üåç',
                color: '#FF9500',
                distance: 280,
                eta: '4 min',
                students: '22',
                teacher: 'Ms. Garcia',
                coordinates: {
                    x: 250,
                    y: 300
                }
            },
            maths: {
                name: 'Maths Expo',
                floor: 1,
                room: '4',
                icon: 'üìê',
                color: '#AF52DE',
                distance: 180,
                eta: '2.5 min',
                students: '28',
                teacher: 'Mr. Johnson',
                coordinates: {
                    x: 250,
                    y: 100
                }
            },
            computer: {
                name: 'Computer Expo',
                floor: 1,
                room: '22',
                icon: 'üíª',
                color: '#32D74B',
                distance: 300,
                eta: '4 min',
                students: '35',
                teacher: 'Ms. Davis',
                coordinates: {
                    x: 400,
                    y: 300
                }
            }
        };

        // State variables
        let currentSubject = null;
        let currentEntrance = 1;
        let currentMapZoom = 1;
        let currentRotation = 0;
        let isNavigating = false;
        let isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        let isTouchDevice = 'ontouchstart' in window;
        let sidebarVisible = false;

        // Initialize application
        function init() {
            // Update time
            updateTime();
            setInterval(updateTime, 60000);

            // Generate subject cards
            generateSubjectCards();

            // Hide loading screen
            setTimeout(() => {
                document.getElementById('loadingScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.display = 'none';
                }, 500);
            }, 1500);

            // Set initial entrance
            selectEntrance(1);

            // Hide sidebar by default
            setTimeout(() => {
                toggleSidebar(false);
            }, 100);

            // Adjust map size
            setTimeout(adjustMapSize, 100);
            
            // Initialize redirect button
            initializeRedirectButton();
        }

        // Initialize redirect button
        function initializeRedirectButton() {
            const redirectButton = document.getElementById('redirectButton');
            
            redirectButton.addEventListener('click', function() {
                // Add iOS-style haptic feedback
                if ('vibrate' in navigator && isMobile) {
                    navigator.vibrate([30, 50, 30]);
                }
                
                // Show loading state
                const originalText = this.innerHTML;
                this.innerHTML = '<span>Redirecting...</span>';
                this.disabled = true;
                
                // Simulate redirection with a small delay for UX
                setTimeout(() => {
                    // Change this URL to your actual Patents Expo page
                    window.location.href = "https://vinothaselvam.github.io/UI_Portfolio/project.html";
                }, 800);
            });
        }

        // Toggle sidebar visibility
        function toggleSidebar(show) {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const mapContainer = document.getElementById('mapContainer');

            if (show === undefined) {
                sidebarVisible = !sidebarVisible;
            } else {
                sidebarVisible = show;
            }

            if (sidebarVisible) {
                sidebar.classList.remove('hidden');
                sidebarToggle.classList.add('hidden');
                sidebarToggle.innerHTML = '‚Üê';
                // Move map container when sidebar is visible
                mapContainer.style.marginLeft = '0';
            } else {
                sidebar.classList.add('hidden');
                sidebarToggle.classList.remove('hidden');
                sidebarToggle.innerHTML = 'üìö';
                // Reset map container position when sidebar is hidden
                mapContainer.style.marginLeft = '0';
                mapContainer.style.width = '100%';
            }

            // Adjust map size after sidebar toggle
            setTimeout(adjustMapSize, 300);
        }

        // Adjust map size based on sidebar visibility
        function adjustMapSize() {
            const uShapedMap = document.getElementById('uShapedMap');
            const mapContainer = document.getElementById('mapContainer');
            const sidebar = document.getElementById('sidebar');

            if (sidebarVisible && window.innerWidth > 768) {
                // When sidebar is visible, map takes remaining space
                mapContainer.style.width = `calc(100% - ${sidebar.offsetWidth}px)`;
                mapContainer.style.marginLeft = `${sidebar.offsetWidth}px`;
                uShapedMap.style.width = 'min(500px, 80%)';
            } else {
                // When sidebar is hidden, map takes full width
                mapContainer.style.width = '100%';
                mapContainer.style.marginLeft = '0';
                uShapedMap.style.width = 'min(600px, 90%)';
            }

            // Adjust map height
            uShapedMap.style.height = 'min(400px, 90%)';
        }

        // Update current time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: false
            }).replace(/^(\d{1,2}):(\d{2})/, (match, h, m) => {
                const hour = parseInt(h);
                return `${hour}:${m}`;
            });

            document.getElementById('currentTime').textContent = timeString;
        }

        // Generate subject cards
        function generateSubjectCards() {
            const grid = document.getElementById('subjectGrid');
            const subjectOrder = ['english', 'tamil', 'science', 'social', 'maths', 'computer'];

            subjectOrder.forEach(subjectId => {
                const subject = subjects[subjectId];
                const card = document.createElement('div');
                card.className = `subject-card ${subjectId}`;
                card.id = `card-${subjectId}`;
                card.onclick = () => {
                    selectSubject(subjectId);
                    // Auto-hide sidebar on mobile after selection
                    if (window.innerWidth < 768) {
                        setTimeout(() => {
                            toggleSidebar(false);
                        }, 300);
                    }
                };

                card.innerHTML = `
                    <div class="subject-icon">${subject.icon}</div>
                    <div class="subject-name">${subject.name.split(' ')[0]}</div>
                    <div class="subject-room">Room ${subject.room}</div>
                `;

                grid.appendChild(card);
            });
        }

        // Select subject
        function selectSubject(subjectId) {
            // Update active states
            document.querySelectorAll('.subject-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelectorAll('.room').forEach(room => {
                room.classList.remove('active');
            });

            // Set active states
            document.getElementById(`card-${subjectId}`).classList.add('active');
            const roomId = subjectId.charAt(0).toUpperCase() + subjectId.slice(1);
            document.getElementById(`room${roomId}`).classList.add('active');

            // Update current subject
            currentSubject = subjects[subjectId];

            // Update info panel
            updateInfoPanel(subjectId);
        }

        // Select subject from modal
        function selectSubjectFromModal(subjectId) {
            selectSubject(subjectId);
            closeQuickSelect();
        }

        // Update info panel
        function updateInfoPanel(subjectId) {
            const subject = subjects[subjectId];

            document.getElementById('currentLocationIcon').textContent = subject.icon;
            document.getElementById('currentLocation').textContent = subject.name;
            document.getElementById('locationStatus').textContent = `Room ${subject.room} ‚Ä¢ Floor ${subject.floor}`;

            document.getElementById('statDistance').textContent = `${subject.distance}m`;
            document.getElementById('statFloor').textContent = subject.floor;
            document.getElementById('statETA').textContent = subject.eta;
            document.getElementById('statRoom').textContent = subject.room;

            // Update navigation button
            const buttonText = window.innerWidth < 480 ? 'Navigate' : `Navigate to ${subject.name.split(' ')[0]}`;
            document.getElementById('navButton').innerHTML = `
                <span>üìç</span>
                <span>${buttonText}</span>
            `;
        }

        // Select entrance
        function selectEntrance(entranceNum) {
            currentEntrance = entranceNum;

            // Update entrance visual feedback
            document.querySelectorAll('.entrance').forEach((entrance, index) => {
                if (index === entranceNum - 1) {
                    entrance.style.transform = 'scale(1.2)';
                    entrance.style.background = 'var(--ios-green)';
                } else {
                    entrance.style.transform = 'scale(1)';
                    entrance.style.background = 'var(--ios-orange)';
                }
            });
        }

        // Start navigation
        function startNavigation() {
            if (!currentSubject || isNavigating) return;

            isNavigating = true;

            // Hide sidebar when starting navigation on mobile
            if (window.innerWidth < 768) {
                toggleSidebar(false);
            }

            // Get start and end points based on map size
            const mapElement = document.querySelector('.u-shaped-map');
            const mapWidth = mapElement.offsetWidth;
            const mapHeight = mapElement.offsetHeight;

            const startX = currentEntrance === 1 ? 50 : mapWidth - 50;
            const startY = mapHeight / 2;
            const endX = (currentSubject.coordinates.x / 600) * mapWidth;
            const endY = (currentSubject.coordinates.y / 400) * mapHeight;

            // Calculate path
            const path = document.getElementById('navPath');
            const dx = endX - startX;
            const dy = endY - startY;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * (180 / Math.PI);

            // Set path
            path.style.left = `${startX}px`;
            path.style.top = `${startY}px`;
            path.style.width = `${distance}px`;
            path.style.transform = `rotate(${angle}deg)`;

            // Animate path
            path.classList.remove('active');
            setTimeout(() => {
                path.classList.add('active');
            }, 100);

            // Position user marker
            const marker = document.getElementById('userMarker');
            marker.style.left = `${startX}px`;
            marker.style.top = `${startY}px`;
            marker.style.display = 'flex';

            // Animate marker along path
            setTimeout(() => {
                marker.style.left = `${endX}px`;
                marker.style.top = `${endY}px`;

                // Show arrival animation
                setTimeout(() => {
                    showArrivalAnimation();
                    isNavigating = false;
                }, 2000);
            }, 500);

            // Update status
            document.getElementById('locationStatus').textContent = `Navigating to Room ${currentSubject.room}...`;
            document.getElementById('locationStatus').style.color = 'var(--ios-green)';
        }

        // Show arrival animation
        function showArrivalAnimation() {
            if (!currentSubject) return;

            // Pulse animation on room
            const roomId = `room${currentSubject.name.split(' ')[0].charAt(0).toUpperCase() + currentSubject.name.split(' ')[0].slice(1).toLowerCase()}`;
            const room = document.getElementById(roomId);

            const originalAnimation = room.style.animation;
            room.style.animation = 'iosPulse 0.5s 3';

            setTimeout(() => {
                room.style.animation = originalAnimation;
            }, 1500);

            // Show success message
            document.getElementById('locationStatus').textContent = `üéâ Arrived at ${currentSubject.name}!`;
            document.getElementById('locationStatus').style.color = 'var(--ios-green)';

            // Show iOS-style haptic feedback
            if ('vibrate' in navigator && isMobile) {
                navigator.vibrate([50, 50, 50]);
            }
        }

        // Find quickest route
        function findQuickestRoute() {
            const message = `üöÄ Recommended Route:
      
1. Start at Entrance ${currentEntrance}
2. Walk to English Expo (Room 20) - 2 min
3. Proceed to Maths Expo (Room 4) - 1.5 min
4. Continue to Science Expo (Room 5) - 1.5 min
5. Turn to Computer Expo (Room 22) - 1 min
6. Visit Social Expo (Room 24) - 1 min
7. End at Tamil Expo (Room 21) - 1 min

Total: 8 minutes walk`;

            if (isMobile) {
                alert(message);
            } else {
                alert(message);
            }
        }

        // Show quick select modal
        function showQuickSelect() {
            document.getElementById('quickSelectModal').classList.add('active');
        }

        // Close quick select modal
        function closeQuickSelect() {
            document.getElementById('quickSelectModal').classList.remove('active');
        }

        // Show location info
        function showLocationInfo() {
            if (!currentSubject) {
                alert("Please select a room first!");
                toggleSidebar(true);
                return;
            }
            showRoomInfo(Object.keys(subjects).find(key => subjects[key] === currentSubject));
        }

        // Show room info modal
        function showRoomInfo(subjectId) {
            const subject = subjects[subjectId];

            // Update modal content
            document.getElementById('modalTitle').textContent = subject.name;
            document.getElementById('modalRoomNumber').textContent = `Room ${subject.room}`;
            document.getElementById('modalSubject').textContent = subject.name;
            document.getElementById('modalDistance').textContent = `${subject.distance}m`;
            document.getElementById('modalETA').textContent = subject.eta;
            document.getElementById('modalTeacher').textContent = subject.teacher;
            document.getElementById('modalStudents').textContent = subject.students;

            // Set current subject
            currentSubject = subject;

            // Show modal
            document.getElementById('roomModal').classList.add('active');

            // Update UI
            selectSubject(subjectId);
        }

        // Navigate to modal room
        function navigateToModalRoom() {
            closeModal();
            startNavigation();
        }

        // Close modal
        function closeModal() {
            document.getElementById('roomModal').classList.remove('active');
        }

        // Map controls
        function zoomIn() {
            currentMapZoom = Math.min(2, currentMapZoom + 0.1);
            updateMapTransform();
        }

        function zoomOut() {
            currentMapZoom = Math.max(0.5, currentMapZoom - 0.1);
            updateMapTransform();
        }

        function rotateLeft() {
            currentRotation += 10;
            updateMapTransform();
        }

        function rotateRight() {
            currentRotation -= 10;
            updateMapTransform();
        }

        function resetMap() {
            currentMapZoom = 1;
            currentRotation = 0;
            updateMapTransform();
        }

        function updateMapTransform() {
            const map = document.querySelector('.u-shaped-map');
            map.style.transform = `
                scale(${currentMapZoom})
                rotate(${currentRotation}deg)
            `;
        }

        // Reset navigation
        function resetNavigation() {
            // Reset states
            currentSubject = null;
            isNavigating = false;

            // Reset UI
            document.querySelectorAll('.subject-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelectorAll('.room').forEach(room => {
                room.classList.remove('active');
            });

            // Reset path and marker
            document.getElementById('navPath').classList.remove('active');
            document.getElementById('userMarker').style.display = 'none';

            // Reset info panel
            document.getElementById('currentLocationIcon').textContent = 'üìç';
            document.getElementById('currentLocation').textContent = 'Select a Room';
            document.getElementById('locationStatus').textContent = 'Choose an exhibit to begin navigation';
            document.getElementById('locationStatus').style.color = '';

            document.getElementById('statDistance').textContent = '--';
            document.getElementById('statRoom').textContent = '--';
            document.getElementById('statETA').textContent = '--';

            // Reset map
            resetMap();

            // Show sidebar for selection
            toggleSidebar(true);

            // Show iOS-style haptic feedback
            if ('vibrate' in navigator && isMobile) {
                navigator.vibrate(100);
            }
        }

        // Toggle theme
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);

            // Save preference
            localStorage.setItem('theme', newTheme);
        }

        // Show help
        function showHelp() {
            const helpMessage = `üì± School Expo Navigation Help:
      
‚Ä¢ Click the üìö button to show/hide subject list
‚Ä¢ Tap any room on the map to select it
‚Ä¢ Use the buttons in the sidebar to navigate
‚Ä¢ Entrance 1 is for parents
‚Ä¢ Follow the green path to your destination
‚Ä¢ Use map controls to zoom and rotate
‚Ä¢ Tap üîÑ to reset your navigation
‚Ä¢ Use üéØ button for quick room selection
‚Ä¢ Use ‚ÑπÔ∏è button for room details
‚Ä¢ Click the orange button to go to Patents Expo`;

            if (isMobile) {
                alert(helpMessage);
            } else {
                alert(helpMessage);
            }
        }

        // Initialize dark mode based on preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.documentElement.setAttribute('data-theme', savedTheme);
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
        }

        // Room click handlers
        document.getElementById('roomEnglish').onclick = () => selectSubject('english');
        document.getElementById('roomTamil').onclick = () => selectSubject('tamil');
        document.getElementById('roomScience').onclick = () => selectSubject('science');
        document.getElementById('roomSocial').onclick = () => selectSubject('social');
        document.getElementById('roomMaths').onclick = () => selectSubject('maths');
        document.getElementById('roomComputer').onclick = () => selectSubject('computer');

        // Window resize handler
        window.addEventListener('resize', adjustMapSize);
        window.addEventListener('orientationchange', () => {
            setTimeout(adjustMapSize, 100);
        });

        // Initialize on load
        window.onload = init;
    </script>
</body>

</html>
